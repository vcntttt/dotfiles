#!/usr/bin/env bash
set -euo pipefail

data="$(cat)"

# Wayland local
if [[ -n "${WAYLAND_DISPLAY:-}" ]] && command -v wl-copy >/dev/null 2>&1; then
  printf "%s" "$data" | wl-copy
  exit 0
fi

# X11 local (por si acaso)
if [[ -n "${DISPLAY:-}" ]] && command -v xclip >/dev/null 2>&1; then
  printf "%s" "$data" | xclip -selection clipboard
  exit 0
fi

# SSH/TTY: OSC52 -> copia al clipboard del PC local (si el terminal lo soporta)
b64="$(printf "%s" "$data" | base64 | tr -d '\n')"
printf '\033]52;c;%s\a' "$b64"
