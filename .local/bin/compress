#!/usr/bin/env bash
set -euo pipefail

name=""
files=()

while [[ $# -gt 0 ]]; do
  case "$1" in
    -n|--name)
      name="${2:-}"
      shift 2
      ;;
    *)
      files+=("$1")
      shift
      ;;
  esac
done

if [[ ${#files[@]} -eq 0 ]]; then
  echo "❌ No se especificaron archivos" >&2
  exit 1
fi

if [[ -z "$name" ]]; then
  printf "Nombre del archivo (sin extensión): "
  IFS= read -r name
fi

if [[ -z "$name" || "$name" == *"/"* ]]; then
  echo "❌ Nombre inválido" >&2
  exit 1
fi

# Comprime en el CWD actual
tar --zstd -cf "${name}.tar.zst" -- "${files[@]}"
echo "✅ Creado: ${name}.tar.zst"
